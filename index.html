<html>
<head>
<title>KnoxelJS</title>

<link rel="stylesheet" type="text/css" href="/css/style.css">

</head>
<body>

<ul class="tab">
    <li><a href="#code" class="tablinks active" id="codeTab" onclick="openTab('code')">Code</a></li>
    <li><a href="#game" class="tablinks" id="gameTab" onclick="openTab('game')">Game</a></li>
</ul>

<div id="game" class="tabcontent">
    <input type="file" id="loadDrawing" class="inputfile">
    <label for="loadDrawing">Load Drawing from JSON</label>
    
    <div id="gamediv" class="game">
    </div>
</div>

<div id="code" class="tabcontent" style="display:block;">
    <button id="runCode" onclick="runCode()">Run code!</button>

    <div id="editor" class="editor">
const width = 2;
const depth = 3;
const height = 4;
let blocks = knoxel.makeGrid(width, depth, height);

for (let w=0; w&lt;width; w++){
    for (let d=0; d&lt;depth; d++){
        for (let h=0; h&lt;height; h++){
            blocks[w][d][h] = "DIRT";
        }
    }
}
knoxel.drawBlocks(blocks);
    </div>
</div>


<script>

function openTab(tabName) {
    let tabcontent = document.getElementsByClassName("tabcontent");
    for (let i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    let tablinks = document.getElementsByClassName("tablinks");
    for (let i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(tabName).style.display = "block";
    document.getElementById(tabName+'Tab').className += " active";
}

function runCode() {
    var studentCode = editor.getValue();
    // security risk, but it's all client-side code with no state, so I don't really care
    eval(studentCode);
    openTab('game');
}
</script>


<!-- load code for the embedded ACE editor -->
<script src="./ace-builds/src-min-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
<script src="./ace-builds/src-min-noconflict/theme-twilight.js" type="text/javascript" charset="utf-8"></script>
<script src="knoxel-bundle.js"></script>

<script>
    // setup the ACE editor
    var editor = ace.edit("editor");
    editor.setTheme("ace/theme/twilight");
    editor.getSession().setMode("ace/mode/javascript");
    editor.setAutoScrollEditorIntoView(true);

    // attach the game object to the game div
    knoxel.game.appendTo(document.getElementById("gamediv"));

    // set the event handler for upload drawing files
    document.getElementById("loadDrawing").onchange = knoxel.loadDrawing;

</script>

</body>
</html>